<!DOCTYPE html>
<html>
  <head>
    <base href='https://towerofnix.github.io/blog/'>
    <meta charset='utf-8'>
    <title>Being sad about how images don't work on the blog's GitHub page (AKA: An explanation of the 'base' HTML tag)</title>
    <meta name='Description' content="Case in point: this.">
    <meta name='twitter:card' content="summary">
    <meta name='twitter:site' content="@towerofnix">
    <meta name='twitter:title' content="Being sad about how images don't work on the blog's GitHub page (AKA: An explanation of the 'base' HTML tag)">
    <meta name='twitter:description' content="Case in point: this.">

    <link rel='stylesheet' href='static/site.css'>
  </head>
  <body>
    <div id='main'>
      <div id='nav'>
        <a href='index.html'>(Front.)</a>
        <a href='about.html'>(About!)</a>
        <a href='archive.html'>(Archive.)</a>
      </div>
      <div id='content'>
        <!-- I'm lazy and don't feel like changing this all into following the "no more than 80 characters on a line" rule; I originally wrote this as a GItHub issue. Sorry! -->
        <h1 id="being-sad-about-how-images-don-t-work-on-the-blog-s-github-page">Being sad about how images don&#39;t work on the blog&#39;s GitHub page</h1>
        <h2 id="-aka-an-explanation-of-the-base-html-tag-">(AKA: An explanation of the <code>&lt;base&gt;</code> HTML tag)</h2>
        <p>Case in point: <a href="https://github.com/towerofnix/blog/blob/38a7b7e0a52e92474ce215b5eae87cf30cf9becd/posts/8-a-snake-maybe.md">this.</a></p>
        <p>The issue is that I cheat<sup>[1]</sup> and use the <a href="https://developer.mozilla.org/en/docs/Web/HTML/Element/base"><code>&lt;base&gt;</code></a> tag to have easier embed URLs for things like images.</p>
        <p>For example, suppose I write <code>my-fancy-post.md</code>, and I want to include the image <code>cool-image.png</code>. My options:</p>
        <ol>
        <li><p>The easy way. Use absolute paths: <code>![Cool image!](/static/media/cool-image.png)</code>. But what if the blog&#39;s root path isn&#39;t <code>/</code>? In fact, it <em>isn&#39;t</em> – my blog&#39;s currently presented at <code>https://towerofnix.github.io/blog/</code>. We&#39;d be embedding <code>https://towerofnix.github.io/static/media/cool-image.png</code>. And that doesn&#39;t exist, of course; I don&#39;t have a <code>static</code> folder under <a href="https://github.com/towerofnix/towerofnix.github.io"><code>liam4.github.io.git</code></a> or <a href="https://github.com/towerofnix/static/">a repository with that name</a>, so GitHub pages considers it to not exist. What we want is <code>https:/<b></b>/liam4.github.io<strong>/blog</strong>/static/cool-image.png</code>.</p>
        </li>
        <li><p>The (just slightly) less easy way. Use relative paths: <code>![Cool image!](../static/media/cool-image.png)</code>. <em>That</em> should work, right? The post HTML documents are stored at <code>(site root)/posts/blah.html</code>, so we&#39;d be referencing <code>(site root)/posts/../static/media/cool-image.png</code>, or, simplified, <code>(site root)/static/media/cool-image.png</code>. Great! It works. Except – hold on. We display the most recent post <a href="https://github.com/towerofnix/blog/issues/1">on the homepage</a>, at <code>(site root)/index.html</code>. That means, from <code>index.html</code>, we&#39;ll be loading <code>(site root)/../static/media/cool-image.png</code>. And that&#39;s not right.<sup>[2]</sup> (citation: option 1).</p>
        </li>
        <li><p>The right way (which takes too long to explain in a single list item). Use <a href="https://developer.mozilla.org/en/docs/Web/HTML/Element/base"><code>&lt;base&gt;</code></a>: <code>&lt;base href=&#39;https://liam4.github.io/blog/&#39;&gt; (..) ![Cool image!](static/media/cool-image.png)</code>.</p>
        </li>
        </ol>
        <p><code>&lt;base&gt;</code> seems like magic at first, but it isn&#39;t really <a href="http://www.catb.org/jargon/html/B/black-magic.html">black magic</a>, because it&#39;s in the spec.<sup>[3]</sup> Basically<sup>[4]</sup>, <code>&lt;base&gt;</code> changes where relative paths are relative to. So by changing it to <code>https://liam4.github.io/blog/</code>, all relative paths are loaded according to that. <code>foo/bar.html</code> will <em>always</em> refer to <code>https://liam4.github.io/blog/foo/bar.html</code>, as long as there&#39;s a <code>&lt;base&gt;</code> tag that href&#39;s to <code>https://liam4.github.io</code> in the document.</p>
        <p>Bonus points for using <code>&lt;base&gt;</code>:</p>
        <ul>
        <li><p>It&#39;s really easy to embed <code>&lt;base&gt;</code> on every page, just by having it be in the <code>&lt;head&gt;</code>-part of my generic blog page template.</p>
        </li>
        <li><p><code>&lt;base&gt;</code> also works on things like links, which makes it <em>really</em> easy to link to any page on the blog, from any page on the blog. (Example: the navigation bar has the same HTML on every page of the blog, but the links still work irregardless of what page the navigation bar actually shows up on. Another: linking to a blog post from anywhere on the site – even other post pages – is easy; just link to <code>posts/post-file.html</code>!)</p>
        </li>
        </ul>
        <p>The only problem with <code>&lt;base&gt;</code> is that when you&#39;re viewing an HTML preview of your markdown file, you don&#39;t get to see the images, since the <code>&lt;base&gt;</code> is ignored while the HTML preview is compiled.<sup>[5]</sup> (It should be pretty clear why – <code>![](static/media/foo.png</code> no longer refers to <code>https://liam4.github.io/static/media/foo.png</code>, but rather, <code>(current directory)/static/media/foo.png</code>, which won&#39;t appear correctly unless <code>(current directory)</code> happens to be the site root (i.e. the directory containing <code>static</code>).)</p>
        <p>I don&#39;t really see a way to solve that, though. The benefits greatly outweigh that cost, so <code>&lt;base&gt;</code> is what I&#39;m using.</p>
        <hr>
        <p>PS, did anybody here by chance know me by my art and not my code?</p>
        <p>..Nah, I&#39;m the only person who follows my blog anyways. And the only other people that do probably know me from (generally) code-writing-based communities, for the stuff I&#39;ve programmed, not my art.</p>
        <!-- PPS, to anybody reading the source code of this post, I've thought about how ending my post with "also, you lost the game" might actually make people comment *less*, since they'll be required to go tell somebody they lost the game (as per The Rules), which is essentially a distraction. Also, you lost the game! -->
        <hr>
        <p><sup>[1] This isn&#39;t actually true; I&#39;m pretty sure I&#39;m following the intended use of <code>&lt;base&gt;</code>. See option 3.</sup></p>
        <p><sup>[2] See option 1.</sup></p>
        <p><sup>[3] &quot;It&#39;s in the spec&quot; doesn&#39;t really make something <em>not</em> <a href="http://www.catb.org/jargon/html/M/magic.html">magic</a>, if nobody can understand what the spec is saying, which is sometimes the case (citation needed). What makes it not magic is that it actually does make sense when I explain it to you (citation needed).</sup></p>
        <p><sup>[4] I get to say that because nobody else says it (since nobody knows about <code>&lt;base&gt;</code>). (Cheesy &quot;all right I&#39;ll leave now&quot; here.)</sup></p>
        <p><sup>[5] <a href="https://daringfireball.net/projects/markdown/syntax#html">Markdown is <em>supposed</em> to let you embed any HTML tags you want into your document</a>, but GitHub doesn&#39;t follow that rule and gets rid of <code>&lt;base&gt;</code> tags (and <em>every</em> tag except for what&#39;s on <a href="https://github.com/jch/html-pipeline/blob/1b5058918eeb0507ac225934cd3e9238f0b94139/lib/html/pipeline/sanitization_filter.rb#L42-L49">their whitelist</a>) when it compiles markdown previews. So, <a href="https://gist.github.com/towerofnix/ac3a23d5fefbde422f44685674f5feac">sure enough</a>, setting the <code>&lt;base&gt;</code> within the markdown document doesn&#39;t work for GitHub markdown previews, which is the use case in which our issue practically lies.</sup></p>
        
        <p class='post-meta'>
          (-towerofnix,
            <a href='https://towerofnix.github.io/blog/posts/9-blog-images-on-gh-and-the-base-tag.html'><time datetime='2017-5-17'>May 17, 2017</time></a>;
            categories: <a href='archive/dev.html'>Development</a>, <a href='archive/text.html'>Text-based Posts</a>)
        </p>
      </div>
    </div>
  </body>
</html>